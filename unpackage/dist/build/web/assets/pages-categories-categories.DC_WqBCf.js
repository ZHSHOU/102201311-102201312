import{d as e,c as t,j as a,o as l,a as i,w as o,r as s,l as n,e as r,f as u,t as c,ar as d,n as f,b as h,i as p,h as b,A as m,I as v,m as _,F as g,p as y,K as w,as as x,B as k,U as C,q as S,g as $,Y as z,J as B,u as P,M as j,$ as I,a0 as T,y as D,N as A,O as E,S as V,v as N,P as F}from"./index-CzFVNye6.js";import{_ as M}from"./unregistered-page.CLnA5iNC.js";import{r as L,b as O,a as W,d as H}from"./uni-app.es.xDvG45QC.js";import{_ as R}from"./wd-icon.C3a6lim4.js";import{_ as G}from"./wd-badge.BiqOnRM7.js";import{u as U,a as K}from"./useChildren.BEcQKJfk.js";import{b as Y,c as q,z as J,e as X,a as Q,m as Z,h as ee}from"./props.Cxz2570m.js";import{_ as te}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{_ as ae}from"./wd-cell.CHbQx4mY.js";import{_ as le}from"./wd-cell-group.CdBUPrJU.js";import{_ as ie}from"./uni-icons.DoyIsjdl.js";import{s as oe,c as se,t as ne}from"./index.CTSRJkC8.js";import"./types.DUQKCkIl.js";import"./config.defalut.DCXQerkV.js";const re=Symbol("wd-sidebar"),ue={...Y,modelValue:q(0)},ce=te(e({name:"wd-sidebar-item",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{...Y,label:J(String),value:J([Number,String]),badge:{type:[String,Number,null],default:null},badgeProps:Object,icon:String,isDot:Boolean,max:X(99),disabled:Q(!1)},setup(e){const b=e,{parent:m}=U(re),v=t((()=>{let e=!1;return m&&m.props.modelValue===b.value&&(e=!0),e})),_=t((()=>{let e=!1;if(m){let t=m.children.findIndex((e=>e.value===m.props.modelValue));m.children.findIndex((e=>e.value===b.value))===t-1&&(e=!0)}return e})),g=t((()=>{let e=!1;if(m){let t=m.children.findIndex((e=>e.value===m.props.modelValue));m.children.findIndex((e=>e.value===b.value))===t+1&&(e=!0)}return e}));function y(){b.disabled||m&&m.setChange(b.value,b.label)}return(e,t)=>{const b=L(a("wd-icon"),R),m=L(a("wd-badge"),G),w=p;return l(),i(w,{onClick:y,class:f(`wd-sidebar-item ${v.value?"wd-sidebar-item--active":""} ${_.value?"wd-sidebar-item--prefix":""}  ${g.value?"wd-sidebar-item--suffix":""} ${e.disabled?"wd-sidebar-item--disabled":""} ${e.customClass}`),style:h(e.customStyle)},{default:o((()=>[s(e.$slots,"icon",{},void 0,!0),!e.$slots.icon&&e.icon?(l(),i(b,{key:0,"custom-class":"wd-sidebar-item__icon",name:e.icon,size:"20px"},null,8,["name"])):n("",!0),r(m,d({"model-value":e.badge,"is-dot":e.isDot,max:e.max},e.badgeProps,{"custom-class":"wd-sidebar-item__badge"}),{default:o((()=>[u(c(e.label),1)])),_:1},16,["model-value","is-dot","max"])])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-0f772ce4"]]),de=te(e({name:"wd-sidebar",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:ue,emits:["change","update:modelValue"],setup(e,{emit:t}){const a=e,{linkChildren:n}=K(re);n({props:a,setChange:function(e,t){u("update:modelValue",e),u("change",{value:e,label:t})}});const u=t;return(e,t)=>{const a=p;return l(),i(a,{class:f(`wd-sidebar ${e.customClass}`),style:h(e.customStyle)},{default:o((()=>[s(e.$slots,"default",{},void 0,!0),r(a,{class:"wd-sidebar__padding"})])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-a2c01b42"]]),fe=te(e({name:"wd-notice-bar",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},props:{...Y,text:{type:[String,Array],default:""},type:Z("warning"),scrollable:Q(!0),delay:X(1),speed:X(50),closable:Q(!1),wrapable:Q(!1),prefix:String,color:String,backgroundColor:String,direction:Z("horizontal")},emits:["close","next"],setup(e,{emit:d}){const C=e,S=b(0),$=b(!0),z=b(""),B=b(""),P=b(0),j=t((()=>Array.isArray(C.text)?C.text:[C.text])),I=t((()=>j.value[P.value])),T=b(0),D=t((()=>"horizontal"===C.direction)),A=t((()=>"vertical"===C.direction)),{proxy:E}=k();m([()=>C.type,()=>C.scrollable,()=>C.wrapable],(()=>{N()}),{deep:!0,immediate:!0}),m([()=>C.text],(()=>{w((()=>async function(){const[e,t]=await O();if(!e.width||!t.width||!t.height)return;S.value=e.width,D.value?C.scrollable&&(z.value=M({duration:t.width/C.speed*1e3,delay:1e3*C.delay,translate:-t.width})):j.value.length>1&&W(t.height)}()))}),{deep:!0,immediate:!0}),v((()=>{N()}));const V=d;function N(){const{type:e,wrapable:t,scrollable:a,direction:l}=C;let i=[];e&&i.push(`is-${e}`),D.value?!t&&!a&&i.push("wd-notice-bar--ellipse"):i.push("wd-notice-bar--ellipse"),t&&!a&&i.push("wd-notice-bar--wrap"),B.value=i.join(" ")}function F(){$.value=!1,V("close")}function M({duration:e,delay:t,translate:a}){const l=x({duration:e,delay:t})[D.value?"translateX":"translateY"](a);return l.step(),l.export()}function O(){return Promise.all([ee(".wd-notice-bar__wrap",!1,E),ee(".wd-notice-bar__content",!1,E)])}async function W(e){const t=-e/(j.value.length+1)*(P.value+1);z.value=M({duration:1e3*C.speed,delay:1e3*C.delay,translate:t})}function H(){D.value?z.value=M({duration:0,delay:0,translate:S.value+1}):++T.value>=j.value.length&&(T.value=0,z.value=M({duration:0,delay:0,translate:0}));const e=setTimeout((()=>{P.value>=j.value.length-1?P.value=0:P.value++,V("next",P.value),w((async()=>{const[e,t]=await O();t.width&&t.height&&(D.value?z.value=M({duration:(S.value+t.width)/C.speed*1e3,delay:1e3*C.delay,translate:-t.width}):W(t.height))})),clearTimeout(e)}),20)}return(e,t)=>{const d=L(a("wd-icon"),R),b=p;return $.value?(l(),i(b,{key:0,class:f(`wd-notice-bar ${e.customClass} ${B.value}`),style:h(`color: ${e.color}; background: ${e.backgroundColor};${e.customStyle}`)},{default:o((()=>[e.prefix?(l(),i(d,{key:0,"custom-class":"wd-notice-bar__prefix",size:"18px",name:e.prefix},null,8,["name"])):s(e.$slots,"prefix",{key:1},void 0,!0),r(b,{class:"wd-notice-bar__wrap"},{default:o((()=>[r(b,{class:"wd-notice-bar__content",animation:z.value,onTransitionend:H},{default:o((()=>[A.value?(l(),_(g,{key:0},[(l(!0),_(g,null,y(j.value,((t,a)=>s(e.$slots,"vertical",{key:t,item:t,index:a},(()=>[r(b,null,{default:o((()=>[u(c(t),1)])),_:2},1024)]),!0))),128)),j.value.length>1?s(e.$slots,"vertical",{key:0,item:j.value[0],index:0},(()=>[r(b,null,{default:o((()=>[u(c(j.value[0]),1)])),_:1})]),!0):n("",!0)],64)):s(e.$slots,"default",{key:1},(()=>[u(c(I.value),1)]),!0)])),_:3},8,["animation"])])),_:3}),e.closable?(l(),i(d,{key:2,"custom-class":"wd-notice-bar__suffix",size:"18px",name:"close-bold",onClick:F})):s(e.$slots,"suffix",{key:3},void 0,!0)])),_:3},8,["class","style"])):n("",!0)}}}),[["__scopeId","data-v-ee7b9b5b"]]);const he=te({name:"UniFab",emits:["fabClick","trigger"],props:{pattern:{type:Object,default:()=>({})},horizontal:{type:String,default:"left"},vertical:{type:String,default:"bottom"},direction:{type:String,default:"horizontal"},content:{type:Array,default:()=>[]},show:{type:Boolean,default:!1},popMenu:{type:Boolean,default:!0}},data:()=>({fabShow:!1,isShow:!1,isAndroidNvue:!1,styles:{color:"#3c3e49",selectedColor:"#007AFF",backgroundColor:"#fff",buttonColor:"#007AFF",iconColor:"#fff",icon:"plusempty"}}),computed:{contentWidth(e){return 55*(this.content.length+1)+15+"px"},contentWidthMin:()=>"55px",boxWidth(){return this.getPosition(3,"horizontal")},boxHeight(){return this.getPosition(3,"vertical")},leftBottom(){return this.getPosition(0,"left","bottom")},rightBottom(){return this.getPosition(0,"right","bottom")},leftTop(){return this.getPosition(0,"left","top")},rightTop(){return this.getPosition(0,"right","top")},flexDirectionStart(){return this.getPosition(1,"vertical","top")},flexDirectionEnd(){return this.getPosition(1,"vertical","bottom")},horizontalLeft(){return this.getPosition(2,"horizontal","left")},horizontalRight(){return this.getPosition(2,"horizontal","right")},nvueBottom:()=>(C().windowBottom,30)},watch:{pattern:{handler(e,t){this.styles=Object.assign({},this.styles,e)},deep:!0}},created(){this.isShow=this.show,0===this.top&&(this.fabShow=!0),this.styles=Object.assign({},this.styles,this.pattern)},methods:{_onClick(){this.$emit("fabClick"),this.popMenu&&(this.isShow=!this.isShow)},open(){this.isShow=!0},close(){this.isShow=!1},_onItemClick(e,t){this.isShow&&this.$emit("trigger",{index:e,item:t})},getPosition(e,t,a){return 0===e?this.horizontal===t&&this.vertical===a:1===e?this.direction===t&&this.vertical===a:2===e?this.direction===t&&this.horizontal===a:this.isShow&&this.direction===t?this.contentWidth:this.contentWidthMin}}},[["render",function(e,t,s,d,b,m){const v=p,w=S,x=$,k=L(a("uni-icons"),ie);return l(),i(v,{class:"uni-cursor-point"},{default:o((()=>[s.popMenu&&(m.leftBottom||m.rightBottom||m.leftTop||m.rightTop)&&s.content.length>0?(l(),i(v,{key:0,class:f([{"uni-fab--leftBottom":m.leftBottom,"uni-fab--rightBottom":m.rightBottom,"uni-fab--leftTop":m.leftTop,"uni-fab--rightTop":m.rightTop},"uni-fab"]),style:h(m.nvueBottom)},{default:o((()=>[r(v,{class:f([{"uni-fab__content--left":"left"===s.horizontal,"uni-fab__content--right":"right"===s.horizontal,"uni-fab__content--flexDirection":"vertical"===s.direction,"uni-fab__content--flexDirectionStart":m.flexDirectionStart,"uni-fab__content--flexDirectionEnd":m.flexDirectionEnd,"uni-fab__content--other-platform":!b.isAndroidNvue},"uni-fab__content"]),style:h({width:m.boxWidth,height:m.boxHeight,backgroundColor:b.styles.backgroundColor}),elevation:"5"},{default:o((()=>[m.flexDirectionStart||m.horizontalLeft?(l(),i(v,{key:0,class:"uni-fab__item uni-fab__item--first"})):n("",!0),(l(!0),_(g,null,y(s.content,((e,t)=>(l(),i(v,{key:t,class:f([{"uni-fab__item--active":b.isShow},"uni-fab__item"]),onClick:a=>m._onItemClick(t,e)},{default:o((()=>[r(w,{src:e.active?e.selectedIconPath:e.iconPath,class:"uni-fab__item-image",mode:"aspectFit"},null,8,["src"]),r(x,{class:"uni-fab__item-text",style:h({color:e.active?b.styles.selectedColor:b.styles.color})},{default:o((()=>[u(c(e.text),1)])),_:2},1032,["style"])])),_:2},1032,["class","onClick"])))),128)),m.flexDirectionEnd||m.horizontalRight?(l(),i(v,{key:1,class:"uni-fab__item uni-fab__item--first"})):n("",!0)])),_:1},8,["class","style"])])),_:1},8,["class","style"])):n("",!0),r(v,{class:f([{"uni-fab__circle--leftBottom":m.leftBottom,"uni-fab__circle--rightBottom":m.rightBottom,"uni-fab__circle--leftTop":m.leftTop,"uni-fab__circle--rightTop":m.rightTop,"uni-fab__content--other-platform":!b.isAndroidNvue},"uni-fab__circle uni-fab__plus"]),style:h({"background-color":b.styles.buttonColor,bottom:m.nvueBottom}),onClick:m._onClick},{default:o((()=>[r(k,{class:f(["fab-circle-icon",{"uni-fab__plus--active":b.isShow&&s.content.length>0}]),type:b.styles.icon,color:b.styles.iconColor,size:"32"},null,8,["type","color","class"])])),_:1},8,["class","style","onClick"])])),_:1})}],["__scopeId","data-v-b7eca566"]]),pe=te(e({__name:"categories",setup(e){const t=z.database(),s=b(""),d=b(0),f=b(),h=b("");let m=b([]),v=B([]);const w=b([]),x=b(""),k=b(10),C=b(!0),$={color:"#7A7E83",backgroundColor:"#fff",selectedColor:"#00bcff",buttonColor:"#00bcff",iconColor:"#fff"},R=[{categoryName:"其他",delete_status:1,last_modify_date:Date.now(),publish_date:Date.now(),publish_ip:"",remark:"系统提示：其他类型下所有数据皆未分类",user_id:"",_id:"-1"}],G=b([{iconPath:"/static/image/categories/leibie.png",selectedIconPath:"/static/image/categories/leibie-s.png",text:"分类",active:!1,path:"/subpackages/sub_categories/categories-add/categories-add"},{iconPath:"/static/image/categories/article.png",selectedIconPath:"/static/image/categories/article-s.png",text:"文章",active:!1,path:"/pages/publish/publish"}]),U=async()=>{if(!se().hasLogin)return j();I({title:"加载中..."}),await t.collection("travel-classify").where("user_id == $cloudEnv_uid && delete_status == 1").get().then((e=>{var t;v=e.result.data.length?[...e.result.data,...R]:R,s.value=v[0]._id,h.value=v[0].remark,w.value=((null==(t=v[0])?void 0:t.fileList)||[]).map((e=>e.url)),K()})).finally((()=>T()))},K=async()=>{x.value="加载中...";const e="-1"==s.value?"":s.value;await t.collection("travel-articles").where(`user_id == $cloudEnv_uid && article_status == 1 && delete_status == 1 && classify_id == "${e}"`).field("classify_id, user_id, title, excerpt, publish_date").orderBy("publish_date","desc").skip(m.value.length).limit(k.value).get().then((e=>{const t=e.result.data;if(!m.value.length&&t.length<k.value&&(C.value=!1),0===t.length)return C.value=!1;m.value=[...m.value,...t]})).finally((()=>{x.value=C.value?"上拉加载更多":"暂无更多数据",j()}))},Y=({value:e})=>{const t=v.find((t=>t._id==e));m.value=[],x.value="加载中...",s.value=e,h.value=(null==t?void 0:t.remark)||"",w.value=((null==t?void 0:t.fileList)||[]).map((e=>e.url)),K()},q=e=>{G.value.forEach(((t,a)=>t.active=e.index===a));const t=e.item.path;t&&(f.value.close(),G.value[e.index].active=!1,t.includes("publish")?D({url:t}):A({url:t}))};O((()=>{C.value=!0,m.value=[],U()}));const J=()=>{C.value&&K()};return W((()=>{U()})),H((()=>{oe.set("currentRoute","categories")})),(e,t)=>{const b=L(a("unregistered-page"),M),k=L(a("wd-sidebar-item"),ce),C=L(a("wd-sidebar"),de),z=S,B=F,j=E,I=p,T=L(a("wd-notice-bar"),fe),D=L(a("wd-cell"),ae),O=L(a("wd-cell-group"),le),W=V,H=L(a("uni-fab"),he);return P(se)().hasLogin?(l(),i(I,{key:1,class:"wraper"},{default:o((()=>[r(C,{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=e=>s.value=e),onChange:Y},{default:o((()=>[(l(!0),_(g,null,y(P(v),(e=>(l(),i(k,{key:e._id,value:e._id,label:e.categoryName},null,8,["value","label"])))),128))])),_:1},8,["modelValue"]),r(I,{class:"content"},{default:o((()=>[r(W,{class:"category","scroll-y":"","scroll-with-animation":"","show-scrollbar":!1,"scroll-top":d.value,throttle:!1,onScrolltolower:J},{default:o((()=>[w.value.length?(l(),i(I,{key:0,style:{padding:"20rpx"}},{default:o((()=>[r(j,{class:"swiper",circular:"","indicator-dots":!1,autoplay:!0,interval:"8000"},{default:o((()=>[(l(!0),_(g,null,y(w.value,((e,t)=>(l(),i(B,{class:"banner-item",key:"ca-banner"+t},{default:o((()=>[r(z,{src:e,mode:"",onClick:e=>(e=>{N({urls:w.value,current:e})})(t)},null,8,["src","onClick"])])),_:2},1024)))),128))])),_:1})])),_:1})):n("",!0),h.value?(l(),i(I,{key:1,style:{padding:"10rpx 20rpx"}},{default:o((()=>[r(T,{text:h.value,type:"info",prefix:"notification",wrapable:"",scrollable:!1},null,8,["text"])])),_:1})):n("",!0),r(O,{border:""},{default:o((()=>[(l(!0),_(g,null,y(P(m),(e=>(l(),i(D,{key:e._id,title:e.title,label:P(ne)(e.publish_date),clickable:"",onClick:t=>{return a=e._id,void A({url:"/subpackages/sub_home/article-details/article-details?id="+a});var a}},null,8,["title","label","onClick"])))),128))])),_:1}),r(I,{class:"load-text"},{default:o((()=>[u(c(x.value),1)])),_:1})])),_:1},8,["scroll-top"])])),_:1}),r(H,{ref_key:"fabRef",ref:f,pattern:$,content:G.value,horizontal:"right",vertical:"bottom",direction:"horizontal",onTrigger:q},null,8,["content"])])),_:1})):(l(),i(b,{key:0}))}}}),[["__scopeId","data-v-6584442e"]]);export{pe as default};
