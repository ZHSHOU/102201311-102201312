import{d as e,Y as a,h as s,J as t,o as l,a as u,w as n,e as o,m as i,p as r,F as d,f as c,t as p,M as _,i as f,u as m,N as g,g as v}from"./index-BKu2siHj.js";import{b as h,c as b,e as k}from"./uni-app.es.D1_Kkzeg.js";import{t as x}from"./index.CapNOk9P.js";import{_ as w}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./config.defalut.DCXQerkV.js";const y=w(e({__name:"pend-message",setup(e){const w=a.database(),y=s([]),j=s(""),C=t({page:1,pageSize:20,total:0}),z=()=>{const{pageSize:e,page:a}=C;j.value="加载中...";const s=w.collection("travel-feed-back").where("process_status == 1").field("_id, user_id, type, excerpt, publish_date, publish_ip").skip((a-1)*e).limit(e).getTemp(),t=w.collection("uni-id-users").field("_id, nickname, username").getTemp();w.collection(s,t).get({getCount:!0}).then((e=>{var s,t;console.log(e,"返回值"),C.total=(null==(s=e.result)?void 0:s.count)||0,y.value=1===a?(null==(t=e.result)?void 0:t.data)||[]:y.value.concat(e.result.data)})).finally((()=>{e*a<C.total?j.value="上拉加载更多":j.value="暂无更多数据",_()}))},S=e=>{const a={1:"产品使用问题",2:"系统BUG",3:"投诉",4:"需求",5:"其他"};if(!a.hasOwnProperty(e))throw new Error(`无效的类型编号: ${e}, 请确保type在1到5之间.`);return a[e]};return h((()=>{C.page=1,z()})),b((()=>{const{total:e,page:a,pageSize:s}=C;e>a*s&&(C.page++,z())})),k((()=>{z()})),(e,a)=>{const s=f,t=v;return l(),u(s,{class:"content"},{default:n((()=>[o(s,{class:"list"},{default:n((()=>[(l(!0),i(d,null,r(y.value,(e=>(l(),u(s,{class:"li",key:e._id,onClick:a=>{return s=e._id,void g({url:"/subpackages/sub_workbench/hand-message/hand-message?id="+s});var s}},{default:n((()=>[o(s,{class:"li-header"},{default:n((()=>[o(s,null,{default:n((()=>[c(p(S(e.type)),1)])),_:2},1024)])),_:2},1024),o(s,{class:"li-content"},{default:n((()=>[c(p(e.excerpt),1)])),_:2},1024),o(s,{class:"li-foot"},{default:n((()=>[o(s,null,{default:n((()=>[o(t,null,{default:n((()=>[c("提交人：")])),_:1}),c(p(e.user_id[0].nickname||e.user_id[0].username||"微信用户"),1)])),_:2},1024),o(s,null,{default:n((()=>[o(t,null,{default:n((()=>[c("提交时间：")])),_:1}),c(p(m(x)(e.publish_date)),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),o(s,{class:"load-text"},{default:n((()=>[c(p(j.value),1)])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-c8524eec"]]);export{y as default};
