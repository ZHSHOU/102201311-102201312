import{d as a,h as e,A as s,c as t,j as l,o,a as n,w as u,r as c,l as i,e as d,b as r,u as p,m,f,t as _,F as y,n as g,i as v,af as k,g as b,Y as h,J as w,p as C,M as x,N as $}from"./index-CzFVNye6.js";import{_ as j}from"./wd-icon.C3a6lim4.js";import{r as S,b as I,c as B,a as z}from"./uni-app.es.xDvG45QC.js";import{b as E,a as V,m as A,o as G}from"./props.Cxz2570m.js";import{u as J}from"./useTranslate.CXMl9qFr.js";import{_ as O}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{t as U}from"./index.CTSRJkC8.js";import"./config.defalut.DCXQerkV.js";const D=O(a({name:"wd-tag",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{...E,useIconSlot:V(!1),type:A("default"),icon:A(""),closable:V(!1),plain:V(!1),dynamic:V(!1),color:A(""),bgColor:A(""),round:V(!1),mark:V(!1)},emits:["click","close","confirm"],setup(a,{emit:h}){const w=a,{translate:C}=J("tag"),x=e(""),$=e(""),I=e(!1);s([()=>w.useIconSlot,()=>w.icon,()=>w.plain,()=>w.dynamic,()=>w.round,()=>w.mark],(()=>{A()}),{deep:!0,immediate:!0}),s((()=>w.type),(a=>{if(!a)return;const e=["primary","danger","warning","success","default"];-1===e.indexOf(a)&&console.error(`type must be one of ${e.toString()}`),A()}),{deep:!0,immediate:!0}),s((()=>I.value),(()=>{A()}),{deep:!0,immediate:!0});const B=t((()=>`wd-tag ${w.customClass} ${x.value}`)),z=t((()=>{const a={};return!w.plain&&w.bgColor&&(a.background=w.bgColor),w.bgColor&&(a["border-color"]=w.bgColor),`${G(a)};${w.customStyle}`})),E=t((()=>{const a={};return w.color&&(a.color=w.color),G(a)})),V=h;function A(){const{type:a,plain:e,round:s,mark:t,dynamic:l,icon:o,useIconSlot:n}=w;let u=[];a&&u.push(`is-${a}`),e&&u.push("is-plain"),s&&u.push("is-round"),t&&u.push("is-mark"),l&&u.push("is-dynamic"),I.value&&u.push("is-dynamic-input"),(o||n)&&u.push("is-icon"),x.value=u.join(" ")}function O(){V("click")}function U(){V("close")}function D(){I.value=!0,$.value=""}function F(){K()}function H(a){K(),V("confirm",{value:a.detail.value})}function K(){I.value=!1}return(a,e)=>{const s=v,t=S(l("wd-icon"),j),h=k,w=b;return o(),n(s,{class:g(B.value),style:r(z.value),onClick:O},{default:u((()=>[a.useIconSlot?(o(),n(s,{key:0,class:"wd-tag__icon"},{default:u((()=>[c(a.$slots,"icon",{},void 0,!0)])),_:3})):a.icon?(o(),n(t,{key:1,name:a.icon,"custom-class":"wd-tag__icon"},null,8,["name"])):i("",!0),d(s,{class:"wd-tag__text",style:r(E.value)},{default:u((()=>[c(a.$slots,"default",{},void 0,!0)])),_:3},8,["style"]),a.closable&&a.round?(o(),n(t,{key:2,"custom-class":"wd-tag__close",name:"error-fill",onClick:U})):i("",!0),I.value&&a.dynamic?(o(),n(h,{key:3,class:"wd-tag__add-text",placeholder:p(C)("placeholder"),type:"text",focus:"true",modelValue:$.value,"onUpdate:modelValue":e[0]||(e[0]=a=>$.value=a),onBlur:F,onConfirm:H},null,8,["placeholder","modelValue"])):a.dynamic?(o(),n(s,{key:4,class:"wd-tag__text",style:r(E.value),onClick:D},{default:u((()=>[a.$slots.add?c(a.$slots,"add",{key:0},void 0,!0):(o(),m(y,{key:1},[d(t,{name:"add","custom-class":"wd-tag__add wd-tag__icon"}),d(w,null,{default:u((()=>[f(_(p(C)("add")),1)])),_:1})],64))])),_:3},8,["style"])):i("",!0)])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-5ab8efbc"]]),F=O(a({__name:"my-feedback",setup(a){const s=h.database(),t=e([]),c=e(""),r=w({page:1,pageSize:20,total:0}),g=()=>{const{pageSize:a,page:e}=r;c.value="加载中...",s.collection("travel-feed-back").where("user_id == $cloudEnv_uid").field("_id, type, excerpt, publish_date, process_status").orderBy("publish_date","desc").skip((e-1)*a).limit(a).get({getCount:!0}).then((a=>{var s,l;r.total=(null==(s=a.result)?void 0:s.count)||0,t.value=1===e?(null==(l=a.result)?void 0:l.data)||[]:t.value.concat(a.result.data)})).finally((()=>{a*e<r.total?c.value="上拉加载更多":c.value="暂无更多数据",x()}))},k=a=>{const e={1:"产品使用问题",2:"系统BUG",3:"投诉",4:"需求",5:"其他"};if(!e.hasOwnProperty(a))throw new Error(`无效的类型编号: ${a}, 请确保type在1到5之间.`);return e[a]};return I((()=>{r.page=1,g()})),B((()=>{const{total:a,page:e,pageSize:s}=r;a>e*s&&(r.page++,g())})),z((()=>{g()})),(a,e)=>{const s=v,r=S(l("wd-tag"),D);return o(),n(s,{class:"content"},{default:u((()=>[d(s,{class:"list"},{default:u((()=>[(o(!0),m(y,null,C(t.value,(a=>(o(),n(s,{class:"li",key:a._id,onClick:e=>{return s=a._id,void $({url:"/subpackages/sub_mine/feedback-detail/feedback-detail?id="+s});var s}},{default:u((()=>[d(s,{class:"li-header"},{default:u((()=>[d(s,null,{default:u((()=>[f(_(k(a.type)),1)])),_:2},1024),d(s,{class:"li-tag"},{default:u((()=>[1===a.process_status?(o(),n(r,{key:0,type:"primary",mark:"",plain:""},{default:u((()=>[f("待处理")])),_:1})):i("",!0),2===a.process_status?(o(),n(r,{key:1,type:"success",mark:"",plain:""},{default:u((()=>[f("已处理")])),_:1})):i("",!0),3===a.process_status?(o(),n(r,{key:2,type:"danger",mark:"",plain:""},{default:u((()=>[f("不予处理")])),_:1})):i("",!0)])),_:2},1024)])),_:2},1024),d(s,{class:"li-content"},{default:u((()=>[f(_(a.excerpt),1)])),_:2},1024),d(s,{class:"li-foot"},{default:u((()=>[d(s,{class:"li-time"},{default:u((()=>[f(_(p(U)(a.publish_date)),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),d(s,{class:"load-text"},{default:u((()=>[f(_(c.value),1)])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-8e06be23"]]);export{F as default};
